<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Members Migration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f8f9fa; padding: 40px; }
        .container { max-width: 800px; }
        .card { border-radius: 15px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .btn-primary { background: #4361ee; border: none; }
        .output { background: #1e1e1e; color: #d4d4d4; padding: 20px; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 14px; max-height: 500px; overflow-y: auto; }
        .success { color: #4ade80; }
        .error { color: #f87171; }
        .warning { color: #fbbf24; }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-body p-5">
                <h2 class="fw-bold mb-2">Family Members Database Migration</h2>
                <p class="text-muted mb-4">Click the button below to create the necessary database tables for family member management.</p>
                
                <button class="btn btn-primary btn-lg w-100 mb-4" onclick="runMigration()">
                    <i class="bi bi-database-fill-gear me-2"></i>Run Migration
                </button>
                
                <div id="output" class="output d-none"></div>
            </div>
        </div>
    </div>

    <script>
        function runMigration() {
            const output = document.getElementById('output');
            output.classList.remove('d-none');
            output.innerHTML = '<span class="text-info">Starting migration...</span><br>';
            
            fetch('run_migration.php')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        output.innerHTML += `<span class="success">✓ Migration completed successfully!</span><br>`;
                        output.innerHTML += `<br>${data.message}<br>`;
                        
                        if (data.tables) {
                            output.innerHTML += `<br><span class="success">Tables created:</span><br>`;
                            data.tables.forEach(table => {
                                output.innerHTML += `<span class="success">  ✓ ${table}</span><br>`;
                            });
                        }
                        
                        output.innerHTML += `<br><span class="text-white-50">You can now navigate to:</span><br>`;
                        output.innerHTML += `<span class="text-white-50">Admin Panel → Homeowners → Click the People icon</span>`;
                    } else {
                        output.innerHTML += `<span class="error">✗ Migration failed!</span><br>`;
                        output.innerHTML += `<span class="error">${data.message}</span>`;
                    }
                })
                .catch(error => {
                    output.innerHTML += `<span class="error">✗ Error: ${error}</span>`;
                });
        }
    </script>
</body>
</html>
